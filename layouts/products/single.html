{{ define "main" }}
<div class="relative flex h-auto min-h-screen w-full flex-col overflow-x-hidden pb-24">
<!-- Top Navigation -->
<nav class="sticky top-0 z-50 flex items-center justify-between bg-background-light/95 dark:bg-background-dark/95 backdrop-blur-sm p-4 px-6 transition-all duration-300">
<button onclick="window.history.back()" class="flex size-10 items-center justify-center rounded-full bg-transparent hover:bg-black/5 dark:hover:bg-white/10 transition-colors">
<span aria-hidden="true" class="material-symbols-outlined text-2xl">arrow_back</span>
</button>
<div class="flex items-center gap-2">
<button class="flex size-10 items-center justify-center rounded-full bg-transparent hover:bg-black/5 dark:hover:bg-white/10 transition-colors relative">
<span aria-hidden="true" class="material-symbols-outlined text-2xl">shopping_bag</span>
<!-- Badge -->
<span class="absolute top-2 right-2 h-2 w-2 rounded-full bg-primary ring-2 ring-background-light dark:ring-background-dark"></span>
</button>
</div>
</nav>
<!-- Main Product Section -->
<main class="flex flex-col gap-8">
<!-- Product Images Container -->
<div class="flex flex-col gap-4">
<!-- Hero Image -->
<div class="w-full px-4 md:px-6">
<div class="relative aspect-[4/5] w-full overflow-hidden rounded-xl bg-neutral-200 dark:bg-neutral-800 shadow-sm">
<div class="absolute inset-0 bg-cover bg-center transition-transform duration-700 hover:scale-105" style="background-image: url('{{ index .Params.images 0 | absURL }}');">
</div>
</div>
</div>
<!-- Thumbnail Gallery -->
<div class="flex w-full overflow-x-auto no-scrollbar px-4 md:px-6 pb-2">
<div class="flex gap-3">
{{ range $index, $image := .Params.images }}
{{ if eq $index 0 }}
<button class="thumbnail group relative h-20 w-20 flex-shrink-0 overflow-hidden rounded-lg border-2 border-primary ring-offset-2 ring-offset-background-light dark:ring-offset-background-dark" data-image="{{ $image | absURL }}">
<div class="h-full w-full bg-cover bg-center opacity-100" style="background-image: url('{{ $image | absURL }}');"></div>
</button>
{{ else }}
<button class="thumbnail group relative h-20 w-20 flex-shrink-0 overflow-hidden rounded-lg border-2 border-transparent hover:border-black/10 dark:hover:border-white/10" data-image="{{ $image | absURL }}">
<div class="h-full w-full bg-cover bg-center transition-opacity" style="background-image: url('{{ $image | absURL }}');"></div>
</button>
{{ end }}
{{ end }}
</div>
</div>
</div>
<!-- Product Details -->
<div class="px-6 flex flex-col gap-6">
<!-- Header Info -->
<div class="space-y-2">
<div class="flex items-start justify-between gap-4">
<h1 class="text-3xl font-bold leading-tight tracking-tight text-soft-black dark:text-white">{{ .Title }}</h1>
<button class="shrink-0 rounded-full p-2 text-neutral-400 hover:bg-neutral-100 dark:hover:bg-neutral-800 hover:text-primary transition-colors">
<span class="material-symbols-outlined" style="font-variation-settings: 'FILL' 0;">favorite</span>
</button>
</div>
<div class="flex items-center gap-3">
<p class="text-2xl font-semibold text-soft-black dark:text-neutral-100">{{ with index .Params.variants 0 }}{{ .actualPrice }}{{ end }}</p>
<div class="h-4 w-[1px] bg-neutral-300 dark:bg-neutral-700"></div>
<div class="flex items-center gap-1">
<span class="material-symbols-outlined text-primary text-lg" style="font-variation-settings: 'FILL' 1;">star</span>
<span class="text-sm font-medium">4.8</span>
<span class="text-sm text-neutral-500 dark:text-neutral-400">(128 reviews)</span>
</div>
</div>
</div>
<!-- Description -->
<div class="space-y-3">
<h3 class="text-sm font-bold uppercase tracking-wider text-neutral-500 dark:text-neutral-400">Description</h3>
<p class="text-base leading-loose text-neutral-700 dark:text-neutral-300">
{{ .Content }}
</p>
</div>
<!-- Attributes / Specs (Optional Mini Grid) -->
<div class="grid grid-cols-2 gap-4 py-2">
<div class="rounded-lg bg-white p-4 dark:bg-white/5 border border-neutral-100 dark:border-neutral-800">
<span class="block text-xs text-neutral-500 dark:text-neutral-400 mb-1">Material</span>
<span class="block font-medium">14k Recycled Gold</span>
</div>
<div class="rounded-lg bg-white p-4 dark:bg-white/5 border border-neutral-100 dark:border-neutral-800">
<span class="block text-xs text-neutral-500 dark:text-neutral-400 mb-1">Chain Length</span>
<span class="block font-medium">18-20 inches</span>
</div>
</div>
<!-- Primary Action -->
<div class="pt-4">
<button class="w-full h-14 bg-primary hover:bg-[#d9a710] active:scale-[0.98] transition-all rounded-lg flex items-center justify-center gap-2 text-soft-black font-bold text-lg shadow-sm">
<span class="material-symbols-outlined">shopping_cart</span>
                        Add to Cart
                    </button>
<p class="text-center text-xs text-neutral-500 mt-3 flex items-center justify-center gap-1">
<span class="material-symbols-outlined text-sm">local_shipping</span>
                        Free shipping on orders over $200
                    </p>
</div>
</div>
<div class="h-[1px] w-full bg-neutral-200 dark:bg-neutral-800 my-2"></div>
<!-- Related Products -->
<div class="px-6 flex flex-col gap-6 pb-8">
<div class="flex items-center justify-between">
<h2 class="text-xl font-bold text-soft-black dark:text-white">You might also love</h2>
<a class="text-sm font-medium text-primary hover:underline" href="/products">View All</a>
</div>
<div class="grid grid-cols-2 gap-x-4 gap-y-8">
{{ $currentCategory := index .Params.categories 0 }}
{{ range $index, $page := where .Site.RegularPages ".Type" "products" }}
{{ if and (ne $page.Permalink $.Permalink) (in $page.Params.categories $currentCategory) }}
{{ if lt $index 4 }}
<div class="group flex flex-col gap-3 cursor-pointer">
<a href="{{ $page.Permalink }}" class="flex flex-col gap-3">
<div class="w-full aspect-[3/4] overflow-hidden rounded-lg bg-neutral-100 dark:bg-neutral-800 relative">
<div class="h-full w-full bg-cover bg-center transition-transform duration-500 group-hover:scale-110" style="background-image: url('{{ $page.Params.thumbnailImage | absURL }}');"></div>
<div class="absolute top-2 right-2 rounded-full bg-white/80 dark:bg-black/50 p-1.5 opacity-0 group-hover:opacity-100 transition-opacity">
<span class="material-symbols-outlined text-sm block">favorite</span>
</div>
</div>
<div class="flex flex-col gap-1">
<h3 class="font-bold text-soft-black dark:text-white truncate">{{ $page.Title }}</h3>
<p class="text-sm text-neutral-600 dark:text-neutral-400">{{ with index $page.Params.variants 0 }}{{ .actualPrice }}{{ end }}</p>
</div>
</a>
</div>
{{ end }}
{{ end }}
{{ end }}
</div>
</div>
</main>
<!-- Sticky Bottom CTA for Mobile feel (Optional based on preference, but good for UX) -->
<div class="fixed bottom-0 left-0 w-full bg-white/80 dark:bg-[#221d10]/90 backdrop-blur-md border-t border-neutral-200 dark:border-neutral-800 p-4 md:hidden z-40 flex items-center gap-4">
<div class="flex flex-col">
<span class="text-xs text-neutral-500 dark:text-neutral-400">Total Price</span>
<span class="font-bold text-lg text-soft-black dark:text-white">{{ with index .Params.variants 0 }}{{ .actualPrice }}{{ end }}</span>
</div>
<button class="flex-1 h-12 bg-primary hover:bg-[#d9a710] rounded-lg text-soft-black font-bold flex items-center justify-center shadow-lg shadow-primary/20">
                 Add to Cart
             </button>
</div>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const heroImage = document.querySelector('.aspect-\\[4\\/5\\]');
    const thumbnails = document.querySelectorAll('.thumbnail');

    thumbnails.forEach((thumbnail) => {
        thumbnail.addEventListener('click', function() {
            const imageUrl = this.getAttribute('data-image');

            // Update hero image
            heroImage.querySelector('div').style.backgroundImage = `url('${imageUrl}')`;

            // Update active thumbnail border
            thumbnails.forEach(btn => {
                btn.classList.remove('border-primary');
                btn.classList.add('border-transparent');
            });
            this.classList.remove('border-transparent');
            this.classList.add('border-primary');
        });
    });
});
</script>
{{ end }}
